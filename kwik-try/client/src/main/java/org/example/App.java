/*
 * This source file was generated by the Gradle 'init' task
 */
package org.example;

import java.util.ArrayList;
import java.util.List;
import java.util.Scanner;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import org.example.commands.SendOver;

import picocli.CommandLine;
import picocli.CommandLine.Command;

@Command(name = "", subcommands = {})
public class App {
    public static void main(String[] args) throws Exception {
        String url = "http://127.0.0.1:7000";
        MyConnectionHandler handler = new MyConnectionHandler();

        Scanner scanner = new Scanner(System.in);
        CommandLine cmd = new CommandLine(new App());
        cmd.addSubcommand("sendOver", new SendOver(handler));

        System.out.println("Shell gestartet. Befehl: sendOver <id> <stream> <msg>");

        while (true) {
            System.out.print("> ");
            String input = scanner.nextLine();

            if (input.equals("exit"))
                break;

            String[] parsedArgs = splitArgs(input);
            cmd.execute(parsedArgs);
        }
    }

    // generiert by gemeni:
    public static String[] splitArgs(String string) {
        List<String> matchList = new ArrayList<String>();
        Pattern regex = Pattern.compile("[^\\s\"]+|\"([^\"]*)\"");
        Matcher regexMatcher = regex.matcher(string);
        while (regexMatcher.find()) {
            if (regexMatcher.group(1) != null)
                matchList.add(regexMatcher.group(1));
            else
                matchList.add(regexMatcher.group());
        }
        return matchList.toArray(new String[0]);
    }
}
